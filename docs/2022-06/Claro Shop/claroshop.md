# Claro Shop

## Fecha de an√°lisis

- **An√°lisis est√°tico (mediante Mobfs):** 1 de junio 2022   
- **An√°lisis est√°tico (mediante Exodus Privacy):** 6 de junio 2022    
- **An√°lisis din√°mico (mediante captura de tr√°fico de red y):**    
- **An√°lisis posteriores:**    

## Descripci√≥n de la aplicaci√≥n

- **Tipo:** Aplicaci√≥n de comercio electr√≥nico de M√©xico
- **Costo:** Gratuito   
- **Link:** [https://play.google.com/store/search?q=claroshop&c=apps&hl=es_MX](https://play.google.com/store/search?q=claroshop&c=apps&hl=es_MX)       
- **Descargas:** 10,000,000+
- **Fecha de actualizaci√≥n:** 24 mayo 2022   
- **Versi√≥n:**  9.7
- **Desarrollador:** __se elimin√≥ de la playstore__ [https://speedy-movil.com.mx/](https://speedy-movil.com.mx/)
- **Firma:**  Speedymovil       
- **Contacto:** __se elimin√≥ de la Playstore__   
- **Condiciones de uso y Pol√≠tica de privacidad:** __se elimin√≥ de la playstore__   
  - [https://app.claroshop.com/aviso-privacidad/](https://app.claroshop.com/aviso-privacidad/)


- **Descripci√≥n en la PlayStore:**       
~~~
Claro shop es el centro comercial digital m√°s grande de
M√©xico, donde compras lo que quieres,
pagas como quieres y recibes donde quieras.
~~~

## Trackers identificados mediante Exodus Privacy

- [Amazon Mobile Analytics (Amplify)](https://docs.amplify.aws/lib/analytics/getting-started/q/platform/android/)
- [Emarsys Predict](https://help.emarsys.com/hc/es/articles/360023168874-Overview-Predict-Overview)
- [Facebook Analytics](https://developers.facebook.com/docs/marketing-api/app-event-api/?locale=es_LA)*
- [Facebook Login](https://developers.facebook.com/docs/facebook-login)
- Facebook Places*
- [Facebook Share](https://developers.facebook.com/docs/sharing)
- Google AdMob [1](https://firebase.google.com/docs/admob/android/quick-start), [2](https://developers.google.com/admob/android/quick-start)
- [Google CrashLytics](https://firebase.google.com/products/crashlytics/)
- [Google Firebase Analytics](https://firebase.google.com/products/analytics)
- [Singular](https://www.singular.net/)

 **Facebook Analytics ya no existe como un tracker separado. Ahora sus funciones pueden ser suplidas por otros trackers. En el caso espec√≠fico de Exodus, la regla de detecci√≥n de este tracker se relaciona con [com.facebook.appevents](https://developers.facebook.com/docs/marketing-api/app-event-api/?locale=es_LA)*

 Enlace a [reporte](https://reports.exodus-privacy.eu.org/es/reports/262262/)

## Empresas relacionadas con esta aplicaci√≥n seg√∫n an√°lisis est√°tico

- Google (Trackers)
- Facebook (Trackers)
- Emarsys (Tracker)
- Amazon (Trackers)
- Singular (Trackers)
- [JourneyApps](https://journeyapps.com/) (Herramienta para implementar lectura de c√≥digo de barras)
- [PayPal](https://www.paypal.com/mx/home) (Pagos seguros)
- [Brain Tree Payments](https://www.braintreepayments.com/it) (Pagos seguros. Pertenece a PayPal)
- [Scarab Research](https://en.wikipedia.org/wiki/Scarab_Research) (Tecnolog√≠a para implementar recomendaciones de productos)
- Cardinal Commerce (Pagos seguros)
- Telmex (??)
- [Instana](https://www.instana.com/) (Monitoreo de la aplicaci√≥n, pertenece a IBM)
- [Squareup](https://developer.squareup.com/es/es) (framework de desarrollo, librer√≠as, etc.)
- [Yotpo](https://www.yotpo.com/)(Plataforma de Marketing)
- [arenagaming.com.mx](https://www.arenagaming.com.mx/) (Servicio de "Escape Rooms"???)
- [Win Image](https://www.winimage.com/winimage.htm) (Desarrollo)
- [UK eScience CA](https://ca.grid-support.ac.uk/) (Certificados)
- [Github](https://github.com/) (Plataforma de desarrollo)

## Empresas relacionadas con esta aplicaci√≥n seg√∫n an√°lisis din√°mico

- Amazon
- Google
- [Radware Cloud Services](https://es.radware.com/products/cloud-services/) (Servicios de infraestructura en la nube y seguridad en la nube)
- [CloudFlare](https://www.cloudflare.com/) CDN (Content distribution Network)
- [Akamai International](https://www.akamai.com/es) CDN (Content distribution Network)
- Twitter
- Facebook
- [Fastly](https://www.fastly.com/es/) Cloud Development Framework
- [Edgecast](https://www.edgecast.com/) CDN ((Content distribution Network)
- [Triara.com](https://telmex.com/web/empresas/servicios-cloud) Host de servicios (Pertenece a Telmex)
- Uninet (Pertenece a Telmex)
- [Automattic](https://automattic.com/about/) Desarrollo de aplicaciones
## Empresas host de actividades dentro de la Aplicaci√≥n

- America M√≥vil
- Sears


## Permisos

- **Seg√∫n la Playstore:** __Ya no lo da la PlayStore__   
- **Seg√∫n Exodus Privacy:** 15 permisos.   
- **Seg√∫n prueba de uso:** 1 permiso.

*Consideramos un subpermiso a aquel que se autoriza de manera secundaria al permitir otro permiso. Ejemplo, si permites acceso a tu red y en consecuencia tambi√©n se da acceso a tu ubicaci√≥n por red.*


### Permisos seg√∫n Exodus Privacy

- ACCESS_NETWORK_STATE   
_View network connections_

- ACCESS_SUPERUSER

- ACCESS_WIFI_STATE
_View Wi-Fi connections_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590237-49e9bf90-9c95-44ae-aea7-5cbecf02a35d.png):exclamation:
CAMERA    
_Take pictures and videos_

- CAMERA2

- FOREGROUND_SERVICE    
_Run foreground service_

- INTERNET   
_Have full network access_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590322-82cf5301-63b1-4ae9-858b-7e3bf648a9ed.png):exclamation:
READ_EXTERNAL_STORAGE    
_Read the contents of your SD card_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590348-1a1efafb-12c4-46c2-ac22-8540514a449d.png):exclamation:
READ_PHONE_STATE    
_Read phone status and identity_

- RECEIVE_BOOT_COMPLETED    
_Run at startup_

- WAKE_LOCK   
_Prevent phone from sleeping_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590322-82cf5301-63b1-4ae9-858b-7e3bf648a9ed.png):exclamation:
WRITE_EXTERNAL_STORAGE    
_Modify or delete the contents of your SD card_

- CHECK_LICENSE

- RECEIVE   

- BIND_GET_INSTALL_REFERRER_SERVICE   


El icono :exclamation: indica un nivel 'Peligroso' o 'Especial' de acuerdo a los [niveles de protecci√≥n de Google](https://developer.android.com/guide/topics/permissions/overview).

### Tabla de relaci√≥n entre permisos y Funciones

| Permisos                          | Funciones relacionadas |
|-----------------------------------|------------------------|
| ACCESS_NETWORK_STATE              |  Internet                      |
| ACCESS_SUPERUSER                  |  Internet                      |
| ACCESS_WIFI_STATE                 |  Internet                      |
| CAMERA                            |  Servicio de pago ZIP                      |
| CAMERA2                           |  No sabemos                      |
| FOREGROUND_SERVICE                |  No sabemos                      |
| INTERNET                          |  Internet                      |
| READ_EXTERNAL_STORAGE             |  No sabemos                      |
| READ_PHONE_STATE                  |  No sabemos                      |
| RECEIVE_BOOT_COMPLETED            |  No sabemos                      |
| WAKE_LOCK                         |  No entrara en modo dormir                      |
| WRITE_EXTERNAL_STORAGE            |  Bajar PDF con informaci√≥n distinta
| CHECK_LICENSE                     |  No sabemos                      |
| RECEIVE                           |  Internet                      |
| BIND_GET_INSTALL_REFERRER_SERVICE |  Firebase Tracker                       |


### Permisos solicitados al usuario durante el uso de la aplicaci√≥n

- üî¥ Acceso a tomar Fotos y V√≠deos (Para pago con ZIP)

üî¥ Este √≠cono indica un permiso obligatorio

## Datos

### Datos solicitados al usuario durante el uso de la Aplicaci√≥n

#### Para el registro:

- üî¥ Nombre
- üî¥ Apellido Paterno
- :white_circle: Apellido Materno
- üî¥ Correo
- ‚ö™ N√∫mero de celular

#### Para env√≠o de productos:

- :red_circle: Direcci√≥n

#### Para solicitar cr√©dito Claro

- üî¥ T√≠tulo
- :red_circle: Nombre
- :red_circle: Apellido Paterno
- :red_circle: Apellido Materno
- :red_circle: Correo
- :red_circle: Celular
- :red_circle: Sexo
- :red_circle: Fecha de nacimiento
- :red_circle: RFC
- :red_circle: No. de dependientes
- :red_circle: Direcci√≥n
- :red_circle: Tipo de vivienda (Propietario, Padres, Rentada, Otros)
- :red_circle: A√±os de residencia en la direcci√≥n indicada  

#### Otros:

- C√≥digo Postal (Si se quieren ofertas cercanas a nuestro lugar)

üî¥ Este √≠cono indica que se debe ingresar este dato de manera obligatoria.   
‚ö™ Este √≠cono indica que estos datos son opcionales.



### Tabla de conexiones realizadas durante el uso de la aplicaci√≥n

| Address         | Country        | City           | AS Organization           |
|-----------------|----------------|----------------|---------------------------|
| 3.80.200.253    | United States  | Ashburn        | AMAZON-AES                |
| 13.33.21.30     | United States  |                | ?????                     |
| 34.95.90.26     | United States  | Kansas City    | GOOGLE                    |
| 34.96.123.93    | United States  | Kansas City    | GOOGLE                    |
| 34.102.218.62   | United States  | Kansas City    | GOOGLE                    |
| 52.217.107.212  | United States  | Ashburn        | AMAZON-02                 |
| 54.247.62.1     | Ireland        | Dublin         | AMAZON-02                 |
| 66.225.237.139  | United States  |                | RADWARE-CLOUD-SERVICES    |
| 66.225.237.226  | United States  |                | RADWARE-CLOUD-SERVICES    |
| 74.125.1.41     | United States  |                | GOOGLE                    |
| 104.16.88.5     |                |                | CLOUDFLARENET             |
| 104.17.184.73   |                |                | CLOUDFLARENET             |
| 104.98.116.145  | United States  | Los Angeles    | Akamai International B.V. |
| 104.98.116.203  | United States  | Los Angeles    | Akamai International B.V. |
| 104.98.117.19   | United States  | Los Angeles    | Akamai International B.V. |
| 104.98.117.25   | United States  | Los Angeles    | Akamai International B.V. |
| 104.244.42.129  | United States  |                | TWITTER                   |
| 104.244.42.131  | United States  |                | TWITTER                   |
| 104.244.42.194  | United States  |                | TWITTER                   |
| 142.250.68.168  | United States  |                | GOOGLE                    |
| 142.250.68.170  | United States  |                | GOOGLE                    |
| 142.250.114.84  | United States  |                | GOOGLE                    |
| 142.250.114.95  | United States  |                | GOOGLE                    |
| 142.250.114.100 | United States  |                | GOOGLE                    |
| 142.250.114.105 | United States  |                | GOOGLE                    |
| 142.250.115.94  | United States  |                | GOOGLE                    |
| 142.250.138.188 | United States  |                | GOOGLE                    |
| 142.251.32.150  | United States  |                | GOOGLE                    |
| 142.251.32.170  | United States  |                | GOOGLE                    |
| 142.251.32.195  | United States  |                | GOOGLE                    |
| 142.251.32.234  | United States  |                | GOOGLE                    |
| 142.251.33.10   | United States  |                | GOOGLE                    |
| 142.251.33.14   | United States  |                | GOOGLE                    |
| 142.251.33.22   | United States  |                | GOOGLE                    |
| 142.251.33.46   | United States  |                | GOOGLE                    |
| 142.251.35.202  | United States  |                | GOOGLE                    |
| 142.251.40.66   | United States  |                | GOOGLE                    |
| 142.251.40.74   | United States  |                | GOOGLE                    |
| 142.251.45.46   | United States  |                | GOOGLE                    |
| 142.251.45.65   | United States  |                | GOOGLE                    |
| 142.251.45.66   | United States  |                | GOOGLE                    |
| 142.251.45.78   | United States  |                | GOOGLE                    |
| 142.251.46.131  | United States  |                | GOOGLE                    |
| 142.251.46.138  | United States  |                | GOOGLE                    |
| 142.251.116.95  | United States  |                | GOOGLE                    |
| 146.75.93.35    | United States  |                | FASTLY                    |
| 151.101.50.49   | United States  | Dallas         | FASTLY                    |
| 151.101.65.35   | United States  |                | FASTLY                    |
| 151.101.129.35  | United States  |                | FASTLY                    |
| 151.101.193.21  | United States  |                | FASTLY                    |
| 152.199.24.185  | United States  |                | EDGECAST                  |
| 157.240.25.1    | Mexico         | Quer√©taro City | FACEBOOK                  |
| 157.240.25.13   | Mexico         | Quer√©taro City | FACEBOOK                  |
| 157.240.25.35   | Mexico         | Quer√©taro City | FACEBOOK                  |
| 157.240.25.60   | Mexico         | Quer√©taro City | FACEBOOK                  |
| 172.217.14.170  | United States  |                | GOOGLE                    |
| 172.232.10.41   | United States  | Los Angeles    | Akamai International B.V. |
| 172.232.10.51   | United States  | Los Angeles    | Akamai International B.V. |
| 185.125.188.60  | United Kingdom |                | Canonical Group Limited   |
| 187.191.74.188  | Mexico         |                | Triara.com, S.A. de C.V.  |
| 189.247.22.17   | Mexico         |                | Uninet S.A. de C.V.       |
| 189.247.22.81   | Mexico         |                | Uninet S.A. de C.V.       |
| 192.0.73.2      | United States  | San Francisco  | AUTOMATTIC                |
| 192.0.77.2      | United States  | San Francisco  | AUTOMATTIC                |
| 192.0.77.32     | United States  | San Francisco  | AUTOMATTIC                |
| 192.0.78.187    | United States  | San Francisco  | AUTOMATTIC                |
| 199.232.94.133  | United States  | Los Angeles    | FASTLY                    |
| 200.57.189.87   | Mexico         | Zona Escolar   | Triara.com, S.A. de C.V.  |
| 216.58.193.131  | United States  |                | GOOGLE                    |
| 216.58.193.150  | United States  |                | GOOGLE                    |

### Mapa de conexiones

## Notas

### Notas sobre datos recolectados

- Las conexiones a Twitter son parte del bot√≥n compartir dentro del Blog de Claro.
- Las llamadas a Facebook tienen que ver con el bot√≥n compartir del Blog, pero tambi√©n los trackers.
- Existe la posibilidad de registrarse a un Newsletter que da la opci√≥n de que sea para Hombre o para Mujer.
- Hay que aceptar de manera expresa los T√©rminos de Uso y de Privacidad cuando uno se registra.

### Notas sobre Permisos

- No nos quedan claras las funciones que se relacionan con varios de los permisos a los que tiene acceso la aplicaci√≥n. Nos preocupa sobre todo READ_PHONE_STATE.
- Hay un permiso, ACCESS_SUPERUSER  que ya es obsoleto, ¬øpor qu√© sigue en la app?


### Notas sobre seguridad

- Hay llamadas en HTTP (texto plano) a uno de los servdiores de Amazon donde se encuentra "mediosplazavip.com" del cual se extraen banners de vendedores dentro de la app.
- La facturaci√≥n electr√≥nica de [ClaroShop](http://facturacionelectronica.claroshop.com/) (que dentro de la app simplemente redirige a esa p√°gina) est√° en HTTP.
- En el an√°lisis est√°tico hecho con Mobfs, tenemos un score de 42/100. Los problemas de mayor vulnerabilidad tienen que ver con que existen conexiones que se pueden establecer en HTTP sin cifrar; la presencia de trackers; varios servicios que se ejecutan que pueden ser accedidos por otras aplicaciones dentro del tel√©fono con la consecuencia de tener acceso a los datos de esos servicios; se utiliza una funci√≥n para hashear que ha demostrado tener colisiones.


## Conclusiones

- La facturaci√≥n electr√≥nica es un desastre. Ah√≠ se insertan datos sensibles de los usuarios y estos no est√°n cifrados.
- La app tiene una cantidad enorme de trackers, de tal manera que no existe ning√∫n tipo de control sobre la privacidad del usuario.
- No probamos la seguridad de los medios de pago.
- Las empresas involucradas en la aplicaci√≥n, tanto a nivel est√°tico como din√°mico, son much√≠simas: otro problema para la privacidad.
- Los permisos a los que tiene acceso la app, en particular READ_PHONE_STATE nos hace creer que se est√°n enviando datos de uso a todos los diferentes trackers sin que podamos, como usuarios, tener alg√∫n control sobre ello. 
