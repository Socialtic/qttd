# Claro Shop

## Fecha de an√°lisis

- **An√°lisis est√°tico (mediante Mobfs):** 1 de junio 2022   
- **An√°lisis est√°tico (mediante Exodus Privacy):** 6 de junio 2022    
- **An√°lisis din√°mico (mediante captura de tr√°fico de red y):**    
- **An√°lisis posteriores:**    

## Descripci√≥n de la aplicaci√≥n

- **Tipo:** Aplicaci√≥n de comercio electr√≥nico de M√©xico
- **Costo:** Gratuito   
- **Link:** [https://play.google.com/store/search?q=claroshop&c=apps&hl=es_MX](https://play.google.com/store/search?q=claroshop&c=apps&hl=es_MX)       
- **Descargas:** 10,000,000+
- **Fecha de actualizaci√≥n:** 24 mayo 2022   
- **Versi√≥n:**  9.7
- **Desarrollador:** __se elimin√≥ de la playstore__ [https://speedy-movil.com.mx/](https://speedy-movil.com.mx/)
- **Firma:**  Speedymovil       
- **Contacto:** __se elimin√≥ de la Playstore__   
- **Condiciones de uso y Pol√≠tica de privacidad:** __se elimin√≥ de la playstore__   
  - [https://app.claroshop.com/aviso-privacidad/](https://app.claroshop.com/aviso-privacidad/)


- **Descripci√≥n en la PlayStore:**       
~~~
Claro shop es el centro comercial digital m√°s grande de
M√©xico, donde compras lo que quieres,
pagas como quieres y recibes donde quieras.
~~~

## Trackers identificados mediante Exodus Privacy

- [Amazon Mobile Analytics (Amplify)](https://docs.amplify.aws/lib/analytics/getting-started/q/platform/android/)
- [Emarsys Predict](https://help.emarsys.com/hc/es/articles/360023168874-Overview-Predict-Overview)
- [Facebook Analytics](https://developers.facebook.com/docs/marketing-api/app-event-api/?locale=es_LA)*
- [Facebook Login](https://developers.facebook.com/docs/facebook-login)
- Facebook Places*
- [Facebook Share](https://developers.facebook.com/docs/sharing)
- Google AdMob [1](https://firebase.google.com/docs/admob/android/quick-start), [2](https://developers.google.com/admob/android/quick-start)
- [Google CrashLytics](https://firebase.google.com/products/crashlytics/)
- [Google Firebase Analytics](https://firebase.google.com/products/analytics)
- [Singular](https://www.singular.net/)

 **Facebook Analytics ya no existe como un tracker separado. Ahora sus funciones pueden ser suplidas por otros trackers. En el caso espec√≠fico de Exodus, la regla de detecci√≥n de este tracker se relaciona con [com.facebook.appevents](https://developers.facebook.com/docs/marketing-api/app-event-api/?locale=es_LA)*

 Enlace a [reporte](https://reports.exodus-privacy.eu.org/es/reports/262262/)

## Empresas relacionadas con esta aplicaci√≥n seg√∫n an√°lisis est√°tico

- Google (Trackers)
- Facebook (Trackers)
- Emarsys (Tracker)
- Amazon (Trackers)
- Singular (Trackers)
- [JourneyApps](https://journeyapps.com/) (Herramienta para implementar lectura de c√≥digo de barras)
- [PayPal](https://www.paypal.com/mx/home) (Pagos seguros)
- [Brain Tree Payments](https://www.braintreepayments.com/it) (Pagos seguros. Pertenece a PayPal)
- [Scarab Research](https://en.wikipedia.org/wiki/Scarab_Research) (Tecnolog√≠a para implementar recomendaciones de productos)
- Cardinal Commerce (Pagos seguros)
- Telmex (??)
- [Instana](https://www.instana.com/) (Monitoreo de la aplicaci√≥n, pertenece a IBM)
- [Squareup](https://developer.squareup.com/es/es) (framework de desarrollo, librer√≠as, etc.)
- [Yotpo](https://www.yotpo.com/)(Plataforma de Marketing)
- [arenagaming.com.mx](https://www.arenagaming.com.mx/) (Servicio de "Escape Rooms"???)
- [Win Image](https://www.winimage.com/winimage.htm) (Desarrollo)
- [UK eScience CA](https://ca.grid-support.ac.uk/) (Certificados)
- [Github](https://github.com/) (Plataforma de desarrollo)


## Permisos

- **Seg√∫n la Playstore:** __Ya no lo da la PlayStore__   
- **Seg√∫n Exodus Privacy:** 15 permisos.   
- **Seg√∫n prueba de uso:**

*Consideramos un subpermiso a aquel que se autoriza de manera secundaria al permitir otro permiso. Ejemplo, si permites acceso a tu red y en consecuencia tambi√©n se da acceso a tu ubicaci√≥n por red.*


### Permisos seg√∫n Exodus Privacy

- ACCESS_NETWORK_STATE   
_View network connections_

- ACCESS_SUPERUSER

- ACCESS_WIFI_STATE
_View Wi-Fi connections_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590237-49e9bf90-9c95-44ae-aea7-5cbecf02a35d.png):exclamation:
CAMERA    
_Take pictures and videos_

- CAMERA2

- FOREGROUND_SERVICE    
_Run foreground service_

- INTERNET   
_Have full network access_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590322-82cf5301-63b1-4ae9-858b-7e3bf648a9ed.png):exclamation:
READ_EXTERNAL_STORAGE    
_Read the contents of your SD card_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590348-1a1efafb-12c4-46c2-ac22-8540514a449d.png):exclamation:
READ_PHONE_STATE    
_Read phone status and identity_

- RECEIVE_BOOT_COMPLETED    
_Run at startup_

- WAKE_LOCK   
_Prevent phone from sleeping_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590322-82cf5301-63b1-4ae9-858b-7e3bf648a9ed.png):exclamation:
READ_EXTERNAL_STORAGE    
_Modify or delete the contents of your SD card_

- CHECK_LICENSE

- RECEIVE   

- BIND_GET_INSTALL_REFERRER_SERVICE   


El icono :exclamation: indica un nivel 'Peligroso' o 'Especial' de acuerdo a los [niveles de protecci√≥n de Google](https://developer.android.com/guide/topics/permissions/overview).

### Permisos solicitados al usuario durante el uso de la aplicaci√≥n



- üî¥ Acceso a tomar Fotos y V√≠deos
- üî¥ Acceso a ubicaci√≥n
- üî¥ Acceso a grabar audio
- üî¥ Acceso a realizar y administart llamadas
- üî¥ Acceso a fotos y contenido multimedia
- üî¥ Acceso a poner en modo silencioso
- üî¥ Acceso a mostrar sobre otras apps

üî¥ Este √≠cono indica un permiso obligatorio

## Datos

### Datos solicitados al usuario durante el uso de la Aplicaci√≥n

- üî¥ N√∫mero de tel√©fono
- üî¥ Correo Electr√≥nico
- üî¥ Nombre
- üî¥ Apellido Paterno
- ‚ö™Apellido Materno
- üî¥ Municipio *S√≥lo est√°n disponibles los de Baja California*
- :red_circle: Sexo
- :red_circle: Fecha de nacimiento
- ‚ö™ Perfil M√©dico
  - Tipo de sangre _5.6.0_
  - Alergias a medicamentos
  - Alergias a alimentos
  - Padecimientos
  - Medicamentos
  - Informaci√≥n adicional   

üî¥ Este √≠cono indica que se debe ingresar este dato de manera obligatoria.   
‚ö™ Este √≠cono indica que estos datos son opcionales.



### Tabla de conexiones realizadas durante el uso de la aplicaci√≥n

| Direcci√≥n IP   | N√∫mero de paquetes | Pa√≠s          | Ciudad  | N√∫mero AS | Organizaci√≥n AS                      |
|----------------|--------------------|---------------|---------|-----------|--------------------------------------|
| 142.250.68.10  |                 88 | United States |         |     15169 | GOOGLE                               |
| 142.250.72.142 |                 45 | United States |         |     15169 | GOOGLE                               |
| 142.250.72.174 |               1979 | United States |         |     15169 | GOOGLE                               |
| 142.250.72.227 |                212 | United States |         |     15169 | GOOGLE                               |
| 142.250.72.234 |                 98 | United States |         |     15169 | GOOGLE                               |
| 142.250.176.10 |                 23 | United States |         |     15169 | GOOGLE                               |
| 142.250.189.10 |                 36 | United States |         |     15169 | GOOGLE                               |
| 142.250.200.3  |                 21 | United States |         |     15169 | GOOGLE                               |
| 142.251.34.170 |                 31 | United States |         |     15169 | GOOGLE                               |
| 142.251.40.35  |                 47 | United States |         |     15169 | GOOGLE                               |
| 142.251.40.42  |                 92 | United States |         |     15169 | GOOGLE                               |
| 142.251.40.46  |                 29 | United States |         |     15169 | GOOGLE                               |
| 142.251.132.3  |                 65 | United States |         |     15169 | GOOGLE                               |
| 200.76.246.116 |              13556 | Mexico        | Tijuana |      6332 | Telefonos del Noroeste, S.A. de C.V. |
| 200.76.246.123 |                503 | Mexico        | Tijuana |      6332 | Telefonos del Noroeste, S.A. de C.V. |
| 216.239.32.3   |                 17 | United States |         |     15169 | GOOGLE                               |

### Mapa de conexiones

### Notas sobre datos recolectados

- La aplicaci√≥n contacta a los servidores de google por dos razones: los mapas y la geolocalizaci√≥n y por el tracker de Firebase (en la nueva versi√≥n tenemos, adem√°s el tracker de AdMob). Firebase recolecta toda una serie de eventos realizados en la aplicaci√≥n. Aqu√≠ los enlaces a todos los eventos y datos que, de manera est√°ndar se recolectan [1](https://support.google.com/firebase/answer/9234069?hl=en&ref_topic=6317484&visit_id=637859685880636053-1936242821&rd=1), [2](https://support.google.com/firebase/answer/9268042?hl=en&ref_topic=6317484&visit_id=637859685880636053-1936242821&rd=1), [3](https://support.google.com/firebase/answer/7029846?hl=en&ref_topic=7029512).
Aqu√≠ la documentaci√≥n al tracker de [AdMob](https://developers.google.com/admob/android/quick-start?hl=es)
- El servidor 066movilbc.seguridadbc.gob.mx con IP: 200.76.246.123 es el _Host_ de la app. Todos los datos que el usuario debe introducir son guardados ah√≠. Las llamadas se hacen en texto plano, HTTP, lo que implica una brecha de seguridad enorme. Se pueden ver los siguientes datos (adem√°s de los proporcionados por el usuario) en las llamadas http:
   - ID de usuario
   - Nuevo Equipo (si al acceder con un n√∫mero ya registrado, se est√° accediendo desde otro equipo al original)
N√∫mero de tel√©fono
   - N√∫mero de confirmaci√≥n que se usa para acceder a la aplicaci√≥n y si este fue aceptado por el servidor de manera correcta. Este n√∫mero de confirmaci√≥n por otro lado, siempre es el mismo cuando se reinicia sesi√≥n. Esto es otro problema de seguridad.
   - Marca del celular
   - Modelo del celular
   - Sistema Operativo
   - Versi√≥n del sistema Operativo  
   - Firebase Token
- Las notificaciones de emergencia hechas con el bot√≥n Violencia de G√©nero (_Bot√≥n Violeta_ en la nueva versi√≥n) y el Bot√≥n de P√°nico, se hacen mediante HTML y tampoco est√°n cifradas. Incluyen estos datos:
   - N√∫mero de tel√©fono
   - Ubicaci√≥n
   - Direcci√≥n (aunque no existe esta funci√≥n)
   - Si el n√∫mero desde el que se mand√≥ la alerta pertenece a una empresa de seguridad privada.
   - N√∫mero de incidente
- La p√°gina [www.seguridad.gob.mx](www.seguridad.gob.mx), en la cual est√°n las funciones de "Estad√≠sticas", "Desaparici√≥n de menores" y "Qu√© hacer", a veces est√° cifrada con HTTPS, y a veces no.  


## Tabla de relaci√≥n entre permisos y funciones

| Permisos  | Funci√≥n relacionada  |
|---|---|
| ACCESS_COARSE_LOCATION  | Servicio de ubicaci√≥n  |
| ACCESS_FINE_LOCATION  | Servicio de ubicaci√≥n  |
| ACCESS_NETWORK_STATE  | Internet  |
| ACCESS_NOTIFICATION_POLICY | Bot√≥n de p√°nico  |
| ANSWER_PHONE_CALLS  | LLamada 911  |
| CALL_PHONE  | Llamadas 911  |
| CAMERA  | Chat (Suponemos esto, debido a funciones similares en otras apps) |
| FOREGROUND_SERVICE  | Llamadas de extorsi√≥n, Bot√≥n de p√°nico  |
| INTERNET  | Internet  |
| MODIFY_AUDIO_SETTINGS  | Bot√≥n de p√°nico, chat.  |
| READ_EXTERNAL_STORAGE  | Subit fotos al chat  |
| READ_PHONE_STATE  | Llamada 911  |
| RECEIVE_BOOT_COMPLETED  | Llamada de extorsi√≥n  |
| RECORD_AUDIO  | Bot√≥n de p√°nico   |
| SYSTEM_ALERT_WINDOW  | Llamadas de extorsi√≥n  |
| VIBRATE  | Bot√≥n de p√°nico   |
| WAKE_LOCK  | Bot√≥n de p√°nico  |
| WRITE_EXTERNAL_STORAGE  | Chat  |
| MAPS_RECEIVE  | Permiso innecesario  |
| RECEIVE  | Push notifications  |
| BIND_GET_INSTALL_REFERRER_SERVICE  | Permiso relacionado con el tracker de Firebase  |
| READ_GSERVICES  | Servicio de ubicaci√≥n  |

### Funciones espec√≠ficas de la aplicaci√≥n

- Tiene una funci√≥n de activar el perfil de Seguridad Privada cuando el n√∫mero registrado sea de un empresa de Seguridad Privada.
- La funci√≥n "Estad√≠sticas" remite a la p√°gina [www.seguridadbc.gob.mx/ExtorsionTelefonica/engano.php](www.seguridadbc.gob.mx/ExtorsionTelefonica/engano.php) donde se pueden revisar los n√∫meros denunciados por extorsi√≥n, las zonas de donde provienen y otros datos.
- Funci√≥n "Menores desaparecidos" permite el acceso a la base datos de menores desaparecidos en sus categor√≠as de Alerta Amber, Regionales, Nacionales y casos resueltos.
- La funci√≥n "Qu√© hacer" remite a una serie de gu√≠as de la p√°gina de la Secretaria de Seguridad Ciudadana.

## Notas

- Dentro de la funci√≥n "Perfil M√©dico", la funci√≥n de Contactos (que son probablemente contactos de emergencia), cierra la app.
- La funci√≥n de n√∫meros de extorsi√≥n se queda activa aunque uno cierre sesi√≥n en la aplicaci√≥n, o la cierre por completo.
- No se prob√≥ la funci√≥n chat por estar fuera del √°rea de servicio, lo mismo con el bot√≥n de p√°nico, la llamada a 911 y el _bot√≥n violeta_. Sin embargo sabemos que estas se hacen en HTTP y no HTTPS.
- No se prob√≥ la funci√≥n Apoyo a cuenthabiente ya que s√≥lo est√° disponible en Tijuana.

## Conclusiones

- La aplicaci√≥n tiene un problema de seguridad enorme al no cifrar las comunicaciones entre el usuario y el servidor _host_ de la app. Esto, adem√°s, implica la pregunta obvia de si los datos que almacenan de los usuarios est√°n cifrados o no y qui√©n tiene acceso a ellos.
- La relaci√≥n entre permisos y funciones es sim√©trica salvo el permiso _maps_receive_ que ya no es necesario para el funcionamiento de google maps desde la versi√≥n 3.1.59 de Google Services.
- Si bien ya es criticable que usen el tracker de Firebase, no se entiende por qu√© en la nueva versi√≥n (5.6.0) agregaron adem√°s el de AdMob. Un tracker que, seg√∫n su propia definici√≥n, sirve para presentar _banners_ con publicidad dentro de la app.
- Cuando se requiere reiniciar sesi√≥n, el n√∫mero de activaci√≥n es el mismo siempre. De tal manera que un actor malintencionado teniendo el n√∫mero de tel√©fono y conociendo este n√∫mero, podr√≠a acceder a la cuenta de otra persona.
- Para reiniciar sesi√≥n solamente se requiere el n√∫mero de tel√©fono y proporcionar un email (que no necesariamente tiene que ser con el que se registr√≥ un usuario), de tal manera que uno puede acceder a los datos de un usuario registrado sin mayor problema.  
- A pesar que maneja datos sensibles (seg√∫n la ley de Privacidad de datos de M√©xico), no pide en ning√∫n momento aceptar de manera expresa la pol√≠tica de privacidad o los T√©rminos de uso.  
